category: CASB
commonfields:
  id: McAfee MVision CASB
  version: -1
configuration:
- defaultvalue: https://www.myshn.net/
  display: Your server URL
  name: url
  required: true
  type: 0
- additionalinfo: The UserName and Password to use for connection
  name: credentials
  required: true
  type: 9
- display: Maximum number of incidents to fetch every time. Default is 50. maximum is 500.
  hidden: false
  name: max_fetch
  required: false
  type: 0
- display: First fetch in timestamp format (<number> <time unit>, e.g., 12 hours,
    7 days). Default is 3 days.
  hidden: false
  name: first_fetch
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Skyhigh CASB is a cloud-based, multi-tenant service that enables Cloud
  Discovery and Risk Monitoring, Cloud Usage Analytics, Cloud Access and Control.
display: McAfee MVision CASB
name: McAfee MVision CASB
script:
  commands:
  - arguments:
    - default: true
      defaultValue: '50'
      description: Maximum number of items that will be returned within a single response.
        Default is 50 maximum is 500. If value exceeds maximum 500 it will not be
        flagged as an error but will also not increase results.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a big “limit” value.
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a big “limit” value. The maximum
        is 500.
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: true
      defaultValue: 3 days
      description: For time arguments use the ISO-8601 standard - '%Y-%m-%dT%H:%M:%SZ'
        or relative time (last X days).
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: For time arguments use the ISO-8601 standard - '%Y-%m-%dT%H:%M:%SZ'
        or relative time (last X days).
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: The actor ids of the incidents to retrieve.
      isArray: true
      name: actor_ids
      required: false
      secret: false
    - default: false
      description: The service names of the incidents to retrieve.
      isArray: true
      name: service_names
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The type of the incidents to retrieve.
      isArray: true
      name: incident_types
      predefined:
      - Alert
      - Threat
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The categories of the incidents to retrieve. When defining the
        categories argument the incident_types argument does not affect.
      isArray: true
      name: categories
      predefined:
      - Access
      - Admin
      - Audit
      - CompromisedAccount
      - Data
      - InsiderThreat
      - Policy
      - PrivilegeAccess
      - Vulnerability
      required: false
      secret: false
    deprecated: false
    description: Retrieves a list of incidents in ascending time modified order.
    execution: false
    name: mvision-casb-incident-query
    outputs:
    - contextPath: MVisionCASB.Incident
      description: The incident that wes returned.
      type: Unknown
  - arguments:
    - default: false
      description: The incidents ids that should be updated.
      isArray: true
      name: incident_ids
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new status of the incidents.
      isArray: false
      name: status
      predefined:
      - new
      - opened
      - false positive
      - resolved
      - suppressed
      - archived
      required: true
      secret: false
    deprecated: false
    description: |-
      Update status of single/multiple incidents.
      Note!
      For multiple Ids  - single status will be changed for all IDs
      e.g. 123, 456, 789 >> change status to >> closed.
    execution: false
    name: mvision-casb-incident-status-update
  - arguments:
    - default: false
      description: The anomaly id from where to retrieve the activities. Only incident
        of type anomaly (ANO-123).
      isArray: false
      name: anomaly_id
      required: true
      secret: false
    deprecated: false
    description: Fetches activities for a given anomaly Id.
    execution: false
    name: mvision-casb-anomaly-activity-list
    outputs:
    - contextPath: MVisionCASB.AnomalyActivity.timeStamp
      description: The timestamp
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.actionName
      description: The action name
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.asnName
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.city
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.collabGroup
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.count
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.country
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.deviceManaged
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.directory
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.downloadBytes
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.eventCount
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.fileFolderPath
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.fileName
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.fileSharingEnabled
      description:
      type: Boolean
    - contextPath: MVisionCASB.AnomalyActivity.fileSize
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.fileType
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.geoOrgNameV1
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.httpMethod
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.instanceId
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.isSourceTrusted
      description:
      type: Boolean
    - contextPath: MVisionCASB.AnomalyActivity.networkType
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.objectType
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.operation
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.proxyDescription
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.proxyType
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.region
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.serviceName
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.siteUrl
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.sourceIP
      description:
      type: IP
    - contextPath: MVisionCASB.AnomalyActivity.sourceIdentifier
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.targetId
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.targetType
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.tenantId
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.threatCategory
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.trustEntity
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.trustReason
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.uploadBytes
      description:
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.url
      description:
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.user
      description:
      type: String
  - arguments:
    - default: false
      description: Maximum number of policies that will be returned within a single
        response. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a big “limit” value.
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a big “limit” value.
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: false
      description: The name of the policies to retrieve.
      isArray: true
      name: name
      required: false
      secret: false
    deprecated: false
    description: List existing Policy Dictionaries.
    execution: false
    name: mvision-casb-policy-dictionary-list
    outputs:
    - contextPath: MVisionCASB.dictionaries.ID
      description: The dictionary ID. This is the unique identifier for the target
        dictionary.
      type: Number
    - contextPath: MVisionCASB.dictionaries.LastModified
      description: The dictionary last modified time
      type: String
    - contextPath: MVisionCASB.dictionaries.Name
      description: The dictionary name
      type: String
  - arguments:
    - default: false
      description: The dictionary where to set the policy.
      isArray: false
      name: dictionary_id
      required: true
      secret: false
    - default: false
      description: A name for the new key-value which will be added in the dictionary.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: The value to be set in the dictionary for the given key-name. Multiple
        values can be separated by commas.
      isArray: false
      name: content
      required: true
      secret: false
    deprecated: false
    description: Adds new content to an existing Policy Dictionaries.
    execution: false
    name: mvision-casb-policy-dictionary-update
  dockerimage: demisto/python3:3.9.8.24399
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 6.0.0
