category: CASB
commonfields:
  id: McAfee MVision CASB
  version: -1
configuration:
- defaultvalue: https://www.myshn.net
  display: Base URL (e.g., https://www.myshn.net)
  name: url
  required: true
  type: 0
- additionalinfo: The username and password to use for the connection.
  name: credentials
  required: true
  type: 9
- display: Maximum number of incidents to fetch every time. Default is 50. Maximum is 500.
  hidden: false
  name: max_fetch
  required: false
  type: 0
- display: First fetch in timestamp format (<number> <time unit>, e.g., 12 hours, 7 days). Default is 3 days.
  hidden: false
  name: first_fetch
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Skyhigh CASB is a cloud-based, multi-tenant service that enables Cloud Discovery and Risk Monitoring, Cloud Usage Analytics, Cloud Access and Control.
display: McAfee MVision CASB
name: McAfee MVision CASB
script:
  commands:
  - arguments:
    - default: true
      defaultValue: '50'
      description: Maximum number of items that will be returned within a single response. Maximum is 500. If the limit value exceeds the 500 maximum, it will not be flagged as an error but will also not increase results.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a large “limit” value.
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a large “limit” value. The maximum is 500.
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: true
      defaultValue: 3 days
      description: For time arguments use the ISO-8601 standard - '%Y-%m-%dT%H:%M:%SZ' or relative time (last X days).
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: For time arguments use the ISO-8601 standard - '%Y-%m-%dT%H:%M:%SZ' or relative time (last X days).
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: The actor IDs of the incidents to retrieve.
      isArray: true
      name: actor_ids
      required: false
      secret: false
    - default: false
      description: The service names of the incidents to retrieve.
      isArray: true
      name: service_names
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The type of the incidents to retrieve.
      isArray: true
      name: incident_types
      predefined:
      - Alert
      - Threat
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The categories of the incidents to retrieve. When defining the categories argument. the incident_types argument is ignored.
      isArray: true
      name: categories
      predefined:
      - Access
      - Admin
      - Audit
      - CompromisedAccount
      - Data
      - InsiderThreat
      - Policy
      - PrivilegeAccess
      - Vulnerability
      required: false
      secret: false
    deprecated: false
    description: Retrieves a list of incidents in ascending time modified order.
    execution: false
    name: mvision-casb-incident-query
    outputs:
    - contextPath: MVisionCASB.Incident
      description: The incident's metadata.
      type: Unknown
  - arguments:
    - default: false
      description: The incidents IDs that should be updated.
      isArray: true
      name: incident_ids
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new status of the incidents.
      isArray: false
      name: status
      predefined:
      - new
      - opened
      - false positive
      - resolved
      - suppressed
      - archived
      required: true
      secret: false
    deprecated: false
    description: |-
      Update status of single/multiple incidents.
      Note!
      For multiple IDs, a single status will be applied for all IDs
      e.g., 123, 456, 789 >> change status to >> closed.
    execution: false
    name: mvision-casb-incident-status-update
  - arguments:
    - default: false
      description: The anomaly ID from where to retrieve the activities. Only for incidents of type anomaly (ANO-123).
      isArray: false
      name: anomaly_id
      required: true
      secret: false
    deprecated: false
    description: Fetches activities for a given anomaly ID.
    execution: false
    name: mvision-casb-anomaly-activity-list
    outputs:
    - contextPath: MVisionCASB.AnomalyActivity.timeStamp
      description: The timestamp of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.actionName
      description: The action name.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.asnName
      description: The ASN name of an activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.city
      description: The city where the anomaly activity occurred.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.collabGroup
      description: The collaboration group for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.count
      description: The number of anomalies detected.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.country
      description: The country of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.deviceManaged
      description: Whether the anomaly activity is managed by the device or not.
      type: Boolean
    - contextPath: MVisionCASB.AnomalyActivity.directory
      description: The directory of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.downloadBytes
      description: The number of bytes downloaded by the anomaly activity.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.eventCount
      description: The number of anomalies detected.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.fileFolderPath
      description: The file folder path for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.fileName
      description: The file name of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.fileSharingEnabled
      description: Whether the CASB file sharing is enabled or not.
      type: Boolean
    - contextPath: MVisionCASB.AnomalyActivity.fileSize
      description: The file size of the anomaly activity.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.fileType
      description: The file type of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.geoOrgNameV1
      description: The geo organization name.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.httpMethod
      description: The HTTP method used by the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.instanceId
      description: The instance ID for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.isSourceTrusted
      description: Whether the anomaly activity source is trusted or not.
      type: Boolean
    - contextPath: MVisionCASB.AnomalyActivity.networkType
      description: The network type for the anomaly.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.objectType
      description: The object type for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.operation
      description: The operation type.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.proxyDescription
      description: The proxy description for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.proxyType
      description: The proxy type for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.region
      description: The Region where the anomaly activity occurred.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.serviceName
      description: The name of the service.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.siteUrl
      description: The URL of the CASB's site.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.sourceIP
      description: The IP address of the source IP.
      type: IP
    - contextPath: MVisionCASB.AnomalyActivity.sourceIdentifier
      description: The source identifier for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.targetId
      description: The target ID for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.targetType
      description: The anomaly activity type.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.tenantId
      description: The tenant ID for the anomaly activity.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.threatCategory
      description: The threat category for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.trustEntity
      description: The trust entity for the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.trustReason
      description: The trust reason of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.uploadBytes
      description: The number of bytes uploaded.
      type: Number
    - contextPath: MVisionCASB.AnomalyActivity.url
      description: The URL of the anomaly activity.
      type: String
    - contextPath: MVisionCASB.AnomalyActivity.user
      description: The user who triggered the anomaly.
      type: String
  - arguments:
    - default: false
      description: Maximum number of policies that will be returned within a single response. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a large “limit” value.
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Pagination support for use with a large “limit” value.
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: false
      description: The name of the policies to retrieve.
      isArray: true
      name: name
      required: false
      secret: false
    deprecated: false
    description: List existing policy dictionaries.
    execution: false
    name: mvision-casb-policy-dictionary-list
    outputs:
    - contextPath: MVisionCASB.dictionaries.ID
      description: The ID for the dictionary.
      type: Number
    - contextPath: MVisionCASB.dictionaries.LastModified
      description: The date the dictionary was last modified.
      type: String
    - contextPath: MVisionCASB.dictionaries.Name
      description: The name of the dictionary.
      type: String
  - arguments:
    - default: false
      description: The dictionary where to set the policy.
      isArray: false
      name: dictionary_id
      required: true
      secret: false
    - default: false
      description: A name for the new key-value which will be added in the dictionary.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: The value to be set in the dictionary for the given key-name. Multiple values can be separated by commas.
      isArray: false
      name: content
      required: true
      secret: false
    deprecated: false
    description: Adds new content to an existing policy dictionary.
    execution: false
    name: mvision-casb-policy-dictionary-update
  dockerimage: demisto/python3:3.9.8.24399
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 6.5.0
